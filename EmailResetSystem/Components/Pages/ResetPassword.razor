@page "/ResetPassword/{username}"
@using ResetSystem.Services
@inject UserService userService
@inject NavigationManager nav
@rendermode InteractiveServer


<h3>Reset Password for @username</h3>

<input type="password" class="form-control" @bind="NewPass" placeholder="New Password" />
<input type="password" class="form-control mt-2" @bind="ConfirmPass" placeholder="Confirm Password" />

<button class="btn btn-primary mt-2" @onclick="Reset">Reset</button>

<p class="text-success">@Message</p>

@code {
    [Parameter] public string username { get; set; } = "";
    string NewPass;
    string ConfirmPass;
    string Message;

    void Reset()
    {
        Message = "";
        if (string.IsNullOrWhiteSpace(NewPass) || NewPass.Length < 6)
        {
            Message = "কমপক্ষে 6 অক্ষরের password দিন।";
            return;
        }
        if (NewPass != ConfirmPass)
        {
            Message = "Password মিলছে না।";
            return;
        }

        var hash = BCrypt.Net.BCrypt.HashPassword(NewPass);
        userService.UpdatePassword(username, hash);
        Message = "Password সফলভাবে আপডেট হয়েছে।";
        nav.NavigateTo("/login");
    }
}
